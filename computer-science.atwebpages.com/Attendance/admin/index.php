<?php
error_reporting(0);
include "connect.php";
include "../../session.php";
ob_start();
sessionStart();
if (!isset($_SESSION['authorized']) || $_SESSION['authorized'] !== true || !isset($_SESSION['role'])) {
  header('location: ../index.php');
  exit();
}

// check for specified roles
$allowedroles = ['admin'];
if (!in_array($_SESSION['role'], $allowedroles)) {
  // if user does not have the required role
  header('location: ../index.php');
  exit();
}
?>

<?php

include('connect.php');

//data insertion
try {

  //checking if the data comes from students form
  if (isset($_POST['std'])) {

    //students data insertion to database table "students"
    $result = mysqli_query($con, "insert into students(st_id,st_name,st_dept,st_batch,st_sem,st_email) values('$_POST[st_id]','$_POST[st_name]','$_POST[st_dept]','$_POST[st_batch]','$_POST[st_sem]','$_POST[st_email]')");
    $success_msg = "Student added successfully.";

  }

  //checking if the data comes from teachers form
  if (isset($_POST['tcr'])) {

    //teachers data insertion to the database table "teachers"
    $res = mysqli_query("insert into teachers(tc_id,tc_name,tc_dept,tc_email,tc_course) values('$_POST[tc_id]','$_POST[tc_name]','$_POST[tc_dept]','$_POST[tc_email]','$_POST[tc_course]')");
    $success_msg = "Teacher added successfully.";
  }

} catch (Execption $e) {
  $error_msg = $e->getMessage();
}

?>



<!DOCTYPE html>
<html lang="en">
<!-- head started -->

<head>
  <title>Attendance Management System</title>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Take-Attendance</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="style1.css">
  <style type="text/css">
    .message {
      padding: 10px;
      font-size: 15px;
      font-style: bold;
      color: black;
    }
  </style>
</head>
<!-- head ended -->

<!-- body started -->

<body>

  <!-- Menus started-->
  <header>
    <?php include "nav.php"; ?>
    <!-- <div class="navbar">
      <a href="signup.php" style="text-decoration:none;">Create Users</a>
      <a href="index.php" style="text-decoration:none;">Add Student/Teacher</a>
      <a href="v-students.php" style="text-decoration:none;">View Students</a>
      <a href="v-teachers.php" style="text-decoration:none;">View Teachers</a>
      <a href="../logout.php" style="text-decoration:none;">Logout</a>

    </div> -->
    <h1>Attendance Management System</h1>

  </header>
  <!-- Menus ended -->


  <!-- Error or Success Message printint started -->
  <div class="message">
    <?php if (isset($success_msg))
      echo $success_msg;
    if (isset($error_msg))
      echo $error_msg; ?>
  </div>
  <!-- Error or Success Message printint ended -->

  <!-- Content, Tables, Forms, Texts, Images started -->
  <center> Select: <a href="#teacher">Teacher</a> | <a href="">Student</a> <br></center>
  <center>

    <div class="content">


      <div class="rowtwo" id="student">



        <form method="post" class="form-horizontal col-md-6 col-md-offset-3">
          <h4>Add Student's Information</h4>
          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Reg. No.</label>
            <div class="col-sm-7">
              <input type="text" name="st_id" class="form-control" id="input1" placeholder="student reg. no." />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Name</label>
            <div class="col-sm-7">
              <input type="text" name="st_name" class="form-control" id="input1" placeholder="student full name" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Department</label>
            <div class="col-sm-7">
              <input type="text" name="st_dept" class="form-control" id="input1" placeholder="department ex. CSE" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Batch</label>
            <div class="col-sm-7">
              <input type="text" name="st_batch" class="form-control" id="input1" placeholder="batch e.x 2020" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Semester</label>
            <div class="col-sm-7">
              <input type="text" name="st_sem" class="form-control" id="input1" placeholder="semester ex. Fall-15" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Email</label>
            <div class="col-sm-7">
              <input type="email" name="st_email" class="form-control" id="input1" placeholder="valid email" />
            </div>
          </div>


          <input type="submit" class="btn btn-primary col-md-2 col-md-offset-8" value="Add Student" name="std" />
        </form>

      </div>
      <br><br><br>
      <div class="rowtwo" id="teacher">


        <form method="post" class="form-horizontal col-md-6 col-md-offset-3">
          <h4>Add Teacher's Information</h4>
          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Teacher ID</label>
            <div class="col-sm-7">
              <input type="text" name="tc_id" class="form-control" id="input1" placeholder="teacher's id" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Name</label>
            <div class="col-sm-7">
              <input type="text" name="tc_name" class="form-control" id="input1" placeholder="teacher full name" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Department</label>
            <div class="col-sm-7">
              <input type="text" name="tc_dept" class="form-control" id="input1" placeholder="department ex. CSE" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Email</label>
            <div class="col-sm-7">
              <input type="email" name="tc_email" class="form-control" id="input1" placeholder="valid email" />
            </div>
          </div>

          <div class="form-group">
            <label for="input1" class="col-sm-3 control-label">Subject Name</label>
            <div class="col-sm-7">
              <input type="text" name="tc_course" class="form-control" id="input1"
                placeholder="subject ex. Software Engineering" />
            </div>
          </div>

          <input type="submit" class="btn btn-primary col-md-2 col-md-offset-8" value="Add Teacher" name="tcr" />
        </form>

      </div>


    </div><br>
    <!-- Contents, Tables, Forms, Images ended -->
  </center>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <style>
    h1 {
      text-align: center;
    }
  </style>
</body>


<!-- Body ended  -->

</html>